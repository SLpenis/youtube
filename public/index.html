<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Visitor Page</title>
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      text-align: center;
      padding: 0 20px;
    }
    h1 {
      font-size: 48px;
      margin-bottom: 6px;
      margin-top: 0;
    }
    h2 {
      font-size: 20px;
      margin-bottom: 6px;
      max-width: 700px;
      line-height: 1.3;
    }
    p {
      font-size: 14px;
      margin-bottom: 12px;
      max-width: 600px;
      line-height: 1.3;
    }
    .form {
      display: flex;
      width: 100%;
      max-width: 600px;
      margin-top: 20px;
    }
    .form input {
      flex-grow: 1;
      padding: 10px;
      font-size: 14px;
    }
    .form button {
      padding: 10px 20px;
      font-size: 14px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Hello, Dear user!</h1>
  <h2>Thank you for providing your personal information, including your IP address, device name, browser, operating system, country, and cookie files. Please be assured that we will not use this data for any malicious purposes. We have no intention of attempting to impersonate you or ddos attack your device. Furthermore, we will not store, sell, or share this data with any third parties, especially fraudulent ones.</h2>
  <p>If you would like us to remove your stored information, require technical support, or wish to send us your very important message, please provide your contact details and message in the field below, and click the "Submit" button.</p>

  <div class="form">
    <input type="text" id="userMessage" placeholder="Your message here..." />
    <button id="submitBtn" onclick="submitMessage()">Submit</button>
  </div>

  <script>
    // Проверяем состояние кнопки при загрузке страницы
    window.onload = () => {
      const timeout = localStorage.getItem('timeout');
      const now = new Date().getTime();
      if (timeout && now < timeout) {
        disableButton((timeout - now) / 1000);
      }
    };

    async function submitMessage() {
      const input = document.getElementById('userMessage');
      const message = input.value.trim();
      if (!message) return;
      
      input.disabled = true;
      const btn = document.getElementById('submitBtn');
      btn.disabled = true;
      
      // Отправка сообщения
      await fetch('/submit', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ message })
      });
      
      input.value = '';
      
      // Блокируем кнопку на 60 секунд
      const timeout = new Date().getTime() + 60000; // 60 секунд
      localStorage.setItem('timeout', timeout);  // Сохраняем время блокировки в localStorage

      disableButton(60);  // Ожидание 60 секунд до разблокировки
    }

    // Функция для отключения кнопки и отображения оставшегося времени
    function disableButton(remainingTime) {
      const btn = document.getElementById('submitBtn');
      btn.disabled = true;
      btn.innerText = `Please wait... (${Math.round(remainingTime)}s)`;

      let interval = setInterval(() => {
        remainingTime -= 1;
        btn.innerText = `Please wait... (${Math.round(remainingTime)}s)`;

        if (remainingTime <= 0) {
          clearInterval(interval);
          btn.disabled = false;
          btn.innerText = 'Submit';
          localStorage.removeItem('timeout');  // Убираем информацию о времени из localStorage
        }
      }, 1000);
    }
  </script>
</body>
</html>
